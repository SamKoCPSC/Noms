version: 1
applications:
  - appRoot: noms
    frontend:
      phases:
        preBuild:
          commands:
            - npm i
        build:
          commands:
            - npm run build
            - GOOGLE_CLIENT_ID = $GOOGLE_CLIENT_ID
            - GOOGLE_CLIENT_SECRET = $GOOGLE_CLIENT_SECRET
            - LAMBDA_API_KEY = $LAMBDA_API_KEY
            - LAMBDA_API_URL = $LAMBDA_API_URL
            - NEXTAUTH_SECRET = $NEXTAUTH_SECRET
            - NEXTAUTH_URL = $NEXTAUTH_URL
            - NOMS_URL = $NOMS_URL
            - S3_ACCESS = $S3_ACCESS
            - S3_BUCKET = $S3_BUCKET
            - S3_REGION = $S3_REGION
            - S3_SECRET = $S3_SECRET
      artifacts:
        baseDirectory: .next
        files:
          - "**/*"
      cache:
        paths:
          - node_modules/**/*
          - .next/cache/**/* 